CREATE TABLE BOOKS_AUD (
	EVENT_ID INT(11) NOT NULL AUTO_INCREMENT,
    EVENT_DATE DATETIME NOT NULL,
    EVENT_TYPE VARCHAR(20) DEFAULT NULL,
    BOOK_ID INT(11) NOT NULL,
    OLD_BOOK_TITLE VARCHAR(255),
    NEW_BOOK_TITLE VARCHAR(255),
    OLD_BOOK_PUBYEAR INT(4),
    NEW_BOOK_PUBYEAR INT(4),
    OLD_BOOK_BESTSELLER TINYINT(1),
    NEW_BOOK_BESTSELLER TINYINT(1),
    PRIMARY KEY (EVENT_ID)
    );



DELIMITER $$

CREATE TRIGGER BOOKS_INSERT AFTER INSERT ON BOOKS
FOR EACH ROW
BEGIN
	INSERT INTO BOOKS_AUD (EVENT_DATE, EVENT_TYPE, BOOK_ID,
		          NEW_BOOK_TITLE, NEW_BOOK_PUBYEAR, NEW_BOOK_BESTSELLER)
	VALUES (CURTIME(), "INSERT", NEW.BOOK_ID,
		NEW.TITLE, NEW.PUBYEAR, NEW.BESTSELLER);
END $$

DELIMITER ;





DELIMITER $$

CREATE TRIGGER BOOKS_DELETE AFTER DELETE ON BOOKS
FOR EACH ROW
BEGIN
	INSERT INTO BOOKS_AUD (EVENT_DATE, EVENT_TYPE, BOOK_ID)
	VALUES (CURTIME(), "DELETE", OLD.BOOK_ID);
END $$

DELIMITER ;





DELIMITER $$

CREATE TRIGGER BOOKS_UPDATE AFTER UPDATE ON BOOKS
FOR EACH ROW
BEGIN
	INSERT INTO BOOKS_AUD (EVENT_DATE, EVENT_TYPE, BOOK_ID,
		NEW_BOOK_TITLE, NEW_BOOK_PUBYEAR, NEW_BOOK_BESTSELLER,
        OLD_BOOK_TITLE, OLD_BOOK_PUBYEAR, OLD_BOOK_BESTSELLER)
	VALUES (CURTIME(), "UPDATE", NEW.BOOK_ID,
		    NEW.TITLE, NEW.PUBYEAR, NEW.BESTSELLER,
        OLD.BOOK_ID, OLD.TITLE, OLD.PUBYEAR, OLD.BESTSELLER
        );
END $$

DELIMITER ;
